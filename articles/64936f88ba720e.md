---
title: "è‡ªå‹•é‹è»¢ã®ãŸã‚ã®å¤§è¦æ¨¡ãªVisual QAãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆãƒ»AutoScenesQAã®ä½œæˆ"
emoji: "ğŸ˜½"
type: "tech"
topics: ["è‡ªå‹•é‹è»¢", "æ©Ÿæ¢°å­¦ç¿’", "è‡ªç„¶è¨€èªå‡¦ç†", "ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ“ã‚¸ãƒ§ãƒ³"]
published: false
publication_name: "turing_motors"
---

æœ¬è¨˜äº‹ã§ã¯ã€Turing ã®ã‚µãƒãƒ¼ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ³ã§ã®æˆæœã‚’ç´¹ä»‹ã—ã¾ã™ã€‚2 é€±é–“ã®ã‚µãƒãƒ¼ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ³ã§ã€**è‡ªå‹•é‹è»¢ã®ãŸã‚ã® VisualÂ Question Answering ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆãƒ»AutoScenesQA** ã®ä½œæˆã‚’è¡Œã„ã¾ã—ãŸã€‚

AutoScenesQA ã¯ã€æ‰‹ä½œæ¥­ã«ã‚ˆã‚‹ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯ãªãã€LLM(GPT 3.5)ã¨ãƒ«ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ã®ãƒ­ã‚¸ãƒƒã‚¯ã‚’æ´»ç”¨ã—ã€**å®Œå…¨ã«è‡ªå‹•**ã§ä½œæˆã•ã‚Œã¦ã„ã¾ã™.

ä»Šå›ä½œæˆã—ãŸ AutoScenesQA ã¯ã€[nuScenes](https://www.nuscenes.org/)ã¨ã„ã†è‡ªå‹•é‹è»¢ç”¨ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’ãƒ™ãƒ¼ã‚¹ã¨ã—ã¦ãŠã‚Šã€ã€Œè»Šè¼‰ã‚«ãƒ¡ãƒ©ã‹ã‚‰æ’®å½±ã—ãŸ 6 æ–¹å‘ã®ç”»åƒ(1 ãƒ•ãƒ¬ãƒ¼ãƒ )ã€ã¨ã€Œãã®ç”»åƒã«å¯¾å¿œã—ãŸ QA ã®ãƒšã‚¢ã€ã§æ§‹æˆã•ã‚Œã¦ã„ã¾ã™ã€‚è‡ªå‹•ç”Ÿæˆã—ãŸ QA ã®ç·æ•°ã¯å…¨éƒ¨ã§**ç´„ 280 ä¸‡ä»¶**ã§ã™ã€‚

æœ¬è¨˜äº‹ã§ã¯ã€AutoScenesQA ã¨ãã®ä½œæˆæ–¹æ³•ã«é–¢ã—ã¦è©³ã—ãç´¹ä»‹ã—ã¾ã™ã€‚

# è‡ªå‹•é‹è»¢ã¨ Visual Question Answering

å–ã‚Šçµ„ã‚“ã å†…å®¹ã«ã¤ã„ã¦èª¬æ˜ã™ã‚‹å‰ã«ã€ã“ã“ã§ã¯å‰æçŸ¥è­˜ã¨ã—ã¦ã€ä½œæˆã—ãŸ AutoScenesQA ãŒå¯¾è±¡ã¨ã—ã¦ã„ã‚‹ã‚¿ã‚¹ã‚¯ã§ã‚ã‚‹ Visual Question Answering ã¨ãã®è‡ªå‹•é‹è»¢ã¸ã®å¿œç”¨ã«ã¤ã„ã¦ç°¡å˜ã«ç´¹ä»‹ã—ã¾ã™ã€‚

è¿‘å¹´ã€ChatGPT ã®ç™»å ´ã‚’çš®åˆ‡ã‚Šã«ã€Large Language Model ã‚„ Vision and Language ã¨ã„ã£ãŸåŸºç›¤ãƒ¢ãƒ‡ãƒ«ã®ç¤¾ä¼šå®Ÿè£…ãŒæ€¥é€Ÿã«é€²ã‚“ã§ã„ã¾ã™ã€‚

Turing ã§ã¯ã€[å®Œå…¨è‡ªå‹•é‹è»¢å®Ÿç¾ã®ãŸã‚ã® LLM ã«é–¢ã™ã‚‹ç ”ç©¶é–‹ç™º](https://github.com/turingmotors/heron)ã‚’é€²ã‚ã¦ã„ã¾ã™ã€‚ã¾ãŸã€ä»Šå¹´ 7 æœˆã«ã¯æ—¥è‹±ä¸¡å¯¾å¿œã® Vision and Language ç”¨ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒª[**Heron**](https://github.com/turingmotors/heron)ã‚’ãƒªãƒªãƒ¼ã‚¹ã—ã¾ã—ãŸã€‚

ä»Šå›æ§‹ç¯‰ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ AutoScenesQA ã¯ Vision and Language ã®ä¸­ã§ã‚‚**Visual Question Answering** (**VQA**)ã¸ã®å¿œç”¨ã‚’æƒ³å®šã—ã¦ã„ã¾ã™ã€‚VQA ã¯ã€ã€Œã‚ã‚‹ç”»åƒã€ã¨ã€Œãã®ç”»åƒã«é–¢ã™ã‚‹è³ªå•(Question)ã€ã«å¯¾ã—ã¦ã€ã€Œæ­£ã—ã„ç­”ãˆã€ã‚’å‡ºåŠ›ã™ã‚‹ã‚¿ã‚¹ã‚¯ã§ã™ã€‚

ä¾‹ãˆã°ã€è»Šã®å‰å·¦éƒ¨(front left)ã«æ­è¼‰ã•ã‚ŒãŸã‚«ãƒ¡ãƒ©ã‹ã‚‰æ’®å½±ã•ã‚ŒãŸä»¥ä¸‹ã®ã‚ˆã†ãªç”»åƒã‚’æƒ³å®šã—ã¾ã™ã€‚

![](https://github-production-user-asset-6210df.s3.amazonaws.com/57289763/277154744-8bd06790-848f-48e3-a265-403f7e9a36a9.png =400x)

VQA ã§ã¯ã€ã“ã®ç”»åƒã«å¯¾ã—ã€ŒAre there any pedestrians to the front left of the car ?(è»Šã®å‰å·¦éƒ¨ã«ã¯æ­©è¡Œè€…ãŒã„ã¾ã™ã‹ï¼Ÿ)ã€ã®ã‚ˆã†ãªè‡ªç„¶æ–‡ã®è³ªå•ã‚’å…¥åŠ›ã—ã€ã€ŒYes, there are 2 pedestrians in the front left of the car.(ã¯ã„ã€è»Šã®å‰å·¦éƒ¨ã«ã¯ 2 äººã®æ­©è¡Œè€…ãŒã„ã¾ã™ã€‚)ã€ã®ã‚ˆã†ãªè‡ªç„¶æ–‡ã§ã®æ­£ã—ã„å›ç­”ã‚’å‡ºåŠ›ãŒå¾—ã‚‰ã‚Œã‚‹ã‚ˆã†ã«ã€æ©Ÿæ¢°å­¦ç¿’ãƒ¢ãƒ‡ãƒ«ã®å­¦ç¿’ã‚’è¡Œã„ã¾ã™ã€‚

ã“ã“ã§è‡ªå‹•é‹è»¢ x VQA ã«é–¢ã™ã‚‹ç ”ç©¶ã‚’ 2 ã¤ã»ã©ç´¹ä»‹ã—ã¾ã™

ã¾ãšã€[NuScenes-QA](https://arxiv.org/abs/2305.14836)ã§ã™ã€‚NuScenes-QA è«–æ–‡ã¯ã€å¾Œè¿°ã™ã‚‹ nuScenes ã¨ã„ã†ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’ãƒ™ãƒ¼ã‚¹ã¨ã—ã¦ã€VQA ç”¨ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ [NuScenes-QA](https://github.com/qiantianwen/nuScenes-QA) ã‚’ä½œæˆã—ã€[MCAN](https://arxiv.org/abs/1906.10770)ã¨ã„ã† VQA ãƒ¢ãƒ‡ãƒ«ã‚’ç”¨ã„ã¦ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³æ¤œè¨¼ã‚’è¡Œã„ã¾ã—ãŸã€‚

ã“ã®ç ”ç©¶ã§ã¯ã€äº‹å‰ã«å®šç¾©ã—ãŸãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã«ã€ã‚‚ã¨ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã§ã‚ã‚‹ nuScenes ã«æ ¼ç´ã•ã‚ŒãŸè»Šã®å‘¨è¾ºç‰©ä½“(è»Šä¸¡ã€äººã€ä¿¡å·æ©Ÿâ€¦etc)ã® 3D BoundingBox æƒ…å ±ã‚„ç‰©ä½“ã®å€‹æ•°ã‚’åŸ‹ã‚è¾¼ã‚“ã§ã„ããƒ«ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ãªãƒ­ã‚¸ãƒƒã‚¯ã‚’å®Ÿè£…ã—ã€QA ã‚’ä½œæˆã—ã¦ã„ã¾ã™ã€‚nuScenes ã«å«ã¾ã‚Œã‚‹ 34,149 ä»¶ã® 6 æ–¹å‘ç”»åƒ(1 ãƒ•ãƒ¬ãƒ¼ãƒ )ã«å¯¾ã—ã¦ã€459,941 ä»¶ã® Question Answering ã®ãƒšã‚¢ã‚’ä½œæˆã—ã¾ã—ãŸã€‚

![](https://github.com/YadaYuki/atcoder-/assets/57289763/22f5c88e-0444-45d0-932a-0053ea5b6275)

æ¬¡ã«[DriveLM](https://github.com/OpenDriveLab/DriveLM)ã§ã™ã€‚DriveLM ã‚‚ NuScenes-QA åŒæ§˜, nuScenes ã‚’ç”¨ã„ã¦ã€VQA ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’ä½œæˆã—ã¾ã—ãŸã€‚ NuScenes-QA ãŒãƒ«ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ã®ãƒ­ã‚¸ãƒƒã‚¯ã‚’å®Ÿè£…ã—å®Œå…¨è‡ªå‹•ã§ç”Ÿæˆã—ã¦ã„ãŸã®ã«å¯¾ã—ã€DriveLM ã¯äººæ‰‹ã§ã€nuScenes ã® 34,149 ä»¶ã® 6 æ–¹å‘ç”»åƒã«å¯¾ã—ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è¡Œã„ã€ç´„ 36 ä¸‡ä»¶ç¨‹åº¦ã® QA ãƒšã‚¢ã‚’ä½œæˆã—ã¾ã—ãŸã€‚

DriveLM ã§ã¯ã€

- å‘¨è¾ºã®é‡è¦ç‰©ä½“ã®ç¾åœ¨ã®çŠ¶æ³ã«é–¢ã™ã‚‹è³ªå•ã‚’ã™ã‚‹**Perception**
- ä¸»ã«å‘¨è¾ºã®é‡è¦ç‰©ä½“ãŒã©ã®æ–¹å‘ã«é€²ã‚€ã‹ã€ãªã©ã®å°†æ¥çš„ãªçŠ¶æ³ã«é–¢ã™ã‚‹è³ªå•ã‚’ã™ã‚‹**Prediction**
- å‘¨è¾ºç‰©ä½“ã®çŠ¶æ³ç­‰ã‹ã‚‰æ¬¡ã«ã©ã®ã‚ˆã†ãªè¡Œå‹•ã‚’ã¨ã‚‹ã¹ãã‹ã‚’è¨ˆç”»ã™ã‚‹**Planning**

ã® 3 ã¤ã«åˆ†é¡ã‚’å®šç¾©ã—ã€ãã‚Œãã‚Œã®ç¨®é¡ã«å¯¾ã—ã¦ã€äººæ‰‹ã§ä½œæˆã‚’è¡Œãªã£ã¦ã„ã¾ã™ã€‚

**Perception < Prediction < Planning ã®é †ã«ã€æ­£ã—ã„å›ç­”ã‚’ã™ã‚‹ãŸã‚ã«ã€ã‚ˆã‚Šäººé–“çš„ãªæ€è€ƒãŒæ±‚ã‚ã‚‰ã‚Œã¾ã™ã€‚**

![DriveLM](https://github.com/OpenDriveLab/DriveLM/assets/57289763/3507089c-8e58-4f02-b1fa-ec0cec8654a8)

ãªãŠã€DriveLM ã¯ã€ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®ä¸€éƒ¨ã§ã‚ã‚‹ QA ã®ãƒ‡ãƒ¢ãƒ‡ãƒ¼ã‚¿ãŒå…¬é–‹ã•ã‚Œã¦ã„ã‚‹ã®ã¿ã§ã€è«–æ–‡ãƒ»ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã„ãšã‚Œã‚‚ 10 æœˆ 23 æ—¥æ™‚ç‚¹ã§æœªå…¬é–‹ã§ã™ã€‚

ä»¥ä¸ŠãŒå…ˆè¡Œç ”ç©¶ã®ç´¹ä»‹ã§ã™ã€‚ä»Šå›ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ³ã§ã¯ã€ã“ã‚Œã‚‰ã®å…ˆè¡Œç ”ç©¶ã‚’å‚è€ƒã«ã—ã¤ã¤ã€nuScenes ã‚’ãƒ™ãƒ¼ã‚¹ã¨ã—ãŸ æ–°ãŸãª VQA ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®æ§‹ç¯‰ãŠã‚ˆã³è‡ªå‹•ã§ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’æ§‹ç¯‰ã™ã‚‹ä»•çµ„ã¿ã®å®Ÿè£…ã«å–ã‚Šçµ„ã¿ã¾ã—ãŸã€‚

# AutoScenesQA

æ—©é€Ÿã§ã™ãŒã€æˆæœç‰©ã®ç´¹ä»‹ã§ã™ã€‚ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ³ã‚’é€šã—ã¦ã€**è‡ªå‹•é‹è»¢ã®ãŸã‚ã® Visual Question Answering ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆãƒ»AutoScenesQA ã‚’ä½œæˆã—ã¾ã—ãŸ**ã€‚

ã™ã§ã«è¿°ã¹ãŸã¨ãŠã‚Šã€AutoScenesQA ã¯ã€è‡ªå‹•é‹è»¢ã«ãŠã‘ã‚‹éå¸¸ã«ãƒãƒ”ãƒ¥ãƒ©ãƒ¼ãªãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®ä¸€ã¤ã§ã‚ã‚‹ [nuScenes](https://www.nuscenes.org/) ã‚’ãƒ™ãƒ¼ã‚¹ã«ã—ã¦ã„ã¾ã™ã€‚ nuScenes ã¯ã€6 æ–¹å‘ã«å–ã‚Šä»˜ã‘ã‚‰ã‚ŒãŸã‚«ãƒ¡ãƒ©ã‹ã‚‰æ’®å½±ã•ã‚ŒãŸè»Šå‘¨è¾ºã®ç”»åƒã¨å‘¨è¾ºã«å­˜åœ¨ã™ã‚‹ç‰©ä½“ã® 3D Bounding Box ãŒä¿å­˜ã•ã‚Œã¦ã„ã¾ã™ã€‚

AutoScenesQA ã¯ã€ã€ŒnuScenes ã® 1 ãƒ•ãƒ¬ãƒ¼ãƒ ã«ãŠã‘ã‚‹ 6 æ–¹å‘ã®ç”»åƒã€ã¨ã€Œç”»åƒã«å¯¾å¿œã™ã‚‹ Question Answer å½¢å¼ã®çŠ¶æ³èª¬æ˜æ–‡ã€ãŒãƒšã‚¢ã«ãªã£ãŸãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã§ã™ã€‚ DriveLM åŒæ§˜ã€QA ã‚’ Perception, Prediction, Planning ã® 3 åˆ†é¡ã¨ã—ã€ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã¯ã€Perception ã® QA ãŒæ ¼ç´ã•ã‚ŒãŸ`perception.json`ã¨ Prediction & Planning ã® QA ãŒæ ¼ç´ã•ã‚ŒãŸ`prediction_and_plan.json`ã® 2 ã¤ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰æ§‹æˆã•ã‚Œã¾ã™ã€‚

AutoScenesQA ã«ã¯ Question-Answering ã®ãƒšã‚¢ãŒ**ç´„ 280 ä¸‡ä»¶**æ ¼ç´ã•ã‚Œã¦ã„ã¾ã™ã€‚ã‚ˆã‚Šè©³ç´°ã«ã¯

- Perception(`perception.json`): 2,842,088 ä»¶
- Prediction & Planning(`prediction_and_plan.json`): 7,000 ä»¶

ã‹ã‚‰æ§‹æˆã•ã‚Œã¦ã„ã¾ã™ã€‚ãªãŠã€æ—¢ã«è¿°ã¹ãŸã¨ãŠã‚Šã€ã“ã‚Œã‚‰ã® QA ã¯ã€LLM ã¨ãƒ«ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ã®ãƒ­ã‚¸ãƒƒã‚¯ã‚’é§†ä½¿ã—ã¦ã€å…¨ã¦è‡ªå‹•ã§ç”Ÿæˆã—ã¾ã—ãŸã€‚

ä»¥é™ã®ç« ã§ã¯ã€ã“ã® AutoScenesQA ã®ä½œæˆéç¨‹ã«é–¢ã—ã¦ã€è©³ã—ãèª¬æ˜ã—ã¦ã„ãã¾ã™ã€‚

# GPT-4 ã«ã‚ˆã‚‹ Visual Question Answering ã®è‡ªå‹•ç”Ÿæˆ

Question Answering ã‚’ã€å®Œå…¨ã«è‡ªå‹•ã§ç”Ÿæˆã™ã‚‹ã«ã‚ãŸã£ã¦ã€ã¾ãšæœ€åˆã«æ¤œè¨ã—ãŸã®ã¯ã€Open AI ã® GPT-4 ã«ã‚ˆã‚Šå…¨ã¦ã® QA ã‚’è‡ªå‹•ç”Ÿæˆã™ã‚‹ã“ã¨ã§ã—ãŸã€‚API ã‹ã‚‰ GPT-4 ã‚’å‘¼ã³å‡ºã™ã“ã¨ã§ã€ã‚¼ãƒ­ã‚·ãƒ§ãƒƒãƒˆã® Question Answering ã®è‡ªå‹•ç”Ÿæˆã‚’è©¦ã¿ã¾ã—ãŸã€‚

ã“ã“ã§ã€GPT-4 ã‚’ã¯ã˜ã‚ã¨ã™ã‚‹ Open AI ãŒæä¾›ã™ã‚‹ã‚µãƒ¼ãƒ“ã‚¹ã«ã¯ã€[OpenAI ãŒæä¾›ã™ã‚‹ãƒ¢ãƒ‡ãƒ«ã‹ã‚‰ã®å‡ºåŠ›ã‚’ç«¶åˆã™ã‚‹ãƒ¢ãƒ‡ãƒ«ã®é–‹ç™ºã«åˆ©ç”¨ã—ã¦ã¯ãªã‚‰ãªã„](https://openai.com/policies/terms-of-use)ã€ã¨ã„ã†è¦ç´„ãŒã‚ã‚Šã¾ã™ã€‚ãã®ãŸã‚åˆ©ç”¨ã«ã¯æ…é‡ã«ãªã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ãŒã€ä»Šå›ã¯ã‚ãã¾ã§ç ”ç©¶ç”¨é€”ã§ã‚ã‚‹ã“ã¨ã¨ è‡ªå‹•é‹è»¢ã®ãŸã‚ã® VQA ã‚¿ã‚¹ã‚¯ã¯ OpenAI ãŒæä¾›ã™ã‚‹ãƒ¢ãƒ‡ãƒ«ã¨ç›´æ¥çš„ãªç«¶åˆã«ã¯ãªã‚‰ãªã„ã¨åˆ¤æ–­ã—ã€ä½¿ç”¨ã™ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚

## å…¥åŠ›ã—ãŸãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ

GPT ã«å…¥åŠ›ã—ãŸãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’èª¬æ˜ã—ã¾ã™ã€‚

Question-Answering ã®ç”Ÿæˆã«ã¯ã€ç”»åƒæƒ…å ±ç­‰ã¯ä¸€æ—¦ç”¨ã„ãšã€nuScenes ã«å…ƒã‹ã‚‰æ ¼ç´ã•ã‚Œã¦ã„ãŸå‘¨è¾ºç‰©ä½“ã® BoundingBox æƒ…å ±ã¨ãã‚Œã‚‰ã‚’äº‹å‰ã«åŠ å·¥ã—ãŸå€¤ã‚’å…¥åŠ›ã¨ã—ã¾ã—ãŸã€‚

nuScenes ã«æ ¼ç´ã•ã‚ŒãŸè»Šå‘¨è¾ºã® Bounding Box æƒ…å ±ã‚’å…ƒã«ã€Œæ’®å½±è€…ã‹ã‚‰ã®ç›¸å¯¾åº§æ¨™ãƒ»çµ¶å¯¾è·é›¢ã€ã€Œã‚«ãƒ¡ãƒ©ãŒæ­è¼‰ã•ã‚ŒãŸ 6 æ–¹å‘(front, front right, back right, back, back left, front left)ã®ãã‚Œãã‚Œã«ã©ã‚“ãªç‰©ä½“ãŒå­˜åœ¨ã™ã‚‹ã‹ã€ã¨è¨€ã£ãŸæƒ…å ±ã‚’äº‹å‰ã«è¨ˆç®—ã—ã¦ã€GPT-4 ã«å…¥åŠ›ã—ã¦ã„ã¾ã™ã€‚

å…·ä½“çš„ã«ã¯ä»¥ä¸‹ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã§ãã‚Œã‚‰ã®æƒ…å ±ã‚’å…¥åŠ›ã—ã¾ã—ãŸã€‚

```
1. Ego-car states:
- Coordinates: (0, 0)

2. List of important objects around the ego-car:

- <adult pedestrian> at (38.122637509683614, 50.66899505384981), moving to (38.122637509683614, 50.66899505384981). Distance from the car: 42.72m
- ...

3. Important objects and its count on six directions:

**front of the ego car**

- '<adult pedestrian>': 17, '<car>': 7, '<bicycle>': 1, '<barrier>': 19, '<truck>': 2, '<construction vehicle>': 1, '<pushable or pullable object>': 1

**front right of the ego car**

```

ãƒ¦ãƒ¼ã‚¶ã®å…¥åŠ›ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã¯ 3 ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«åˆ†ã‹ã‚Œã¦ãŠã‚Šã€ãã‚Œãã‚Œä»¥ä¸‹ã®æƒ…å ±ãŒè¨˜è¼‰ã•ã‚Œã¦ã„ã¾ã™.

1. `Ego-car states`: Ego-car(é‹è»¢è»Š)ã® xy åº§æ¨™
2. `List of important objects around the ego-car`: Ego-car(é‹è»¢è»Š)å‘¨è¾ºã®é‡è¦ç‰©ä½“ã® xy åº§æ¨™(Ego-car åŸºæº–)ã¨ ego-car ã¨ã®çµ¶å¯¾è·é›¢(m)
3. `Important objects and its count on six directions`: 6 æ–¹å‘ãã‚Œãã‚Œã«å¯¾ã—ã¦ã€ã©ã®ç‰©ä½“ãŒä½•å€‹å­˜åœ¨ã™ã‚‹ã‹ã€ã‚’`'{ç‰©ä½“å}':{å€‹æ•°}`ã®å½¢å¼ã§è¨˜è¼‰

ã¾ãŸã€GPT-4 ã®å…¨ä½“çš„ãªæŒ¯ã‚‹èˆã„ã‚’æ±ºå®šã¥ã‘ã‚‹**ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ**ã¯ã€ä»¥ä¸‹ã«ãªã‚Šã¾ã™ã€‚

```
**Overall Role**

- You are a very attentive car drive, always looking around your surroundings.
- Please output a detailed situation description to the "handle_drive" function based on the information provided.
- The car is operated based on the information you input into "handle_drive".

**Input Format**
User input can be divided into the following three sections:

1. "Ego-car states": Information about the state of car you are driving.
2. "List of important objects around the ego-car": A list of the 'coordinates' and 'intended movement coordinates' of objects around the car you are driving, as well as the 'absolute distance' from the car you are riding in.
3. "Important objects and its count on six directions"

**Output Format**

- Describe the situation in the format of a "question" and an "answer".
- Provide a json format object list of "question" and "answer" pairs to "question_answer_list" that describe the situation.

**Rules and Precautions**

- Make the questions general in content and do not include information specific to the situation the user has entered. For example, "What is the important object behind the ego car?", "Is there any pedestrian?".
- Output various questions and answers for all directions
- **Provide 50 QA pairs at least.**
- Please answer politely.
```

ã“ã¡ã‚‰ã¯ 4 ã¤ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‹ã‚‰åˆ†ã‹ã‚Œã¦ãŠã‚Šã€ãã‚Œãã‚Œä»¥ä¸‹ã®æƒ…å ±ãŒè¨˜è¼‰ã•ã‚Œã¦ã„ã¾ã™.

- `Overall Role`: GPT ã«ã€Œã‚ãªãŸã¯æ³¨æ„æ·±ã„ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã§å‘¨å›²ã«å¸¸ã«æ³¨æ„ã‚’æ‰•ã£ã¦ã„ã‚‹ã€ã¨ã„ã†å½¹å‰²ã‚’èªè­˜ã•ã›ã‚‹ã€‚ãã®ä¸Šã§ã€å¾Œè¿°ã™ã‚‹ Function Calling ã®`handle_drive`ã«å‘¨è¾ºçŠ¶æ³ã®èª¬æ˜ã‚’ QA å½¢å¼ã§å‡ºåŠ›ã™ã‚‹ã‚ˆã†ã«ä¼ãˆã‚‹ã€‚
- `Input Format`: å‰è¿°ã—ãŸãƒ¦ãƒ¼ã‚¶ã®å…¥åŠ›ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã¨ãã‚Œãã‚Œã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«ä½•ãŒæ›¸ã‹ã‚Œã¦ã„ã‚‹ã‹ã€ã‚’ä¼ãˆã‚‹
- `Output Format`: `question`ã¨`answer`ã¨ã„ã†ã‚­ãƒ¼ã‚’æŒã¤ json ã®é…åˆ—å½¢å¼ã§å‡ºåŠ›ã™ã‚‹ã‚ˆã†ã«ä¼ãˆã‚‹
- `Rules and Precautions`: ã€Œ50 ç¨‹åº¦ã® QA ã‚’ç”Ÿæˆã™ã‚‹ã“ã¨ã€ã‚„ã€Œ`answer`ã‚’ä¸å¯§ã«è¨˜è¿°ã™ã‚‹ã“ã¨ã€ç­‰ã‚’ä¼ãˆã‚‹ã€‚

## Function Calling ã®åˆ©ç”¨

ç¹°ã‚Šè¿”ã—è¿°ã¹ã¦ã„ã‚‹ã‚ˆã†ã«ã€ä»Šå›ç”Ÿæˆã™ã‚‹ã®ã¯ Question Answering å½¢å¼ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã§ã™ã€‚å˜ãªã‚‹çŠ¶æ³èª¬æ˜æ–‡ã§ã¯ãªãã€ã“ã®ã‚ˆã†ã«ã€å½¢å¼ã‚’ç¢ºå®Ÿã«æŒ‡å®šã—ãŸã„ã¨ãã«ä¾¿åˆ©ãªã®ãŒã€OpenAI ã® Function Calling ã§ã™ã€‚

Function Calling ã§å‡ºåŠ›ã‚¹ã‚­ãƒ¼ãƒã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã§ã€ç¢ºå®Ÿã« Question-Answering å½¢å¼ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’å‡ºåŠ›ã™ã‚‹ã‚ˆã†ã«ã—ã¾ã—ãŸã€‚ä»¥ä¸‹ã®`handle_drive`ã¨ã„ã† Function ã‚’å®šç¾©ã—ã€å¿…ãšã“ã® Function ã‚’å‘¼ã³å‡ºã™ã‚ˆã†ã«è¨­å®šã—ã¾ã—ãŸã€‚

```python
functions_schema = [
    {
        "name": "handle_drive",
        "description": "operate car based on input 'question' and 'answer'",
        "parameters": {
            "type": "object",
            "properties": {
                "question": {
                    "type": "string",
                    "description": "Question that asks about the surrounding situation.",
                },
                "answer": {
                    "type": "string",
                    "description": "Answer for question that describe surrounding situation.",
                },
            },
            "required": ["question", "answer"],
        },
    }
]
```

## å‡ºåŠ›çµæœ

ä»¥ä¸Šã®å…¥åŠ›ãƒ»è¨­å®šã‚’è¡Œã„ã€GPT-4 ã‹ã‚‰å¾—ã‚‰ã‚ŒãŸå‡ºåŠ›ãŒä»¥ä¸‹ã«ãªã‚Šã¾ã™ã€‚

:::details GPT-4 ã«ã‚ˆã‚‹ Question-Answering ã®ç”Ÿæˆçµæœ

```json
{
  "question_answer_list": [
    {
      "question": "What is the important object in front left of the ego car?",
      "answer": "There is 1 adult pedestrian and 1 truck in front left of the ego car."
    },
    {
      "question": "How many important objects are there in front of the ego car?",
      "answer": "In front of the ego car, there are 17 adult pedestrians, 7 cars, 1 bicycle, 19 barriers, 2 trucks, 1 construction vehicle and 1 pushable or pullable object."
    },
    {
      "question": "What objects are in front right of the ego car?",
      "answer": "In front right of the ego car, there are 8 adult pedestrians, 3 cars, 6 barriers and 1 traffic cone."
    },
    {
      "question": "How many pedestrians are in the back left of the ego vehicle?",
      "answer": "There are 2 adult pedestrians in the back left of the ego vehicle."
    },
    {
      "question": "What objects are behind the ego car?",
      "answer": "Behind the ego car, there are 2 traffic cones, 1 car, 2 barriers, 4 adult pedestrians, and 1 rigid bus."
    },
    {
      "question": "How many important objects are there in the back right of the ego vehicle?",
      "answer": "In the back right of the car, there are 4 adult pedestrians and 1 barrier."
    },
    {
      "question": "Is there any pedestrian in sight?",
      "answer": "Yes, there are pedestrians in all directions."
    },
    {
      "question": "Is there any car in sight?",
      "answer": "Yes, there are cars in the front and the back."
    },
    {
      "question": "Is there any barriers in sight?",
      "answer": "Yes, there are barriers in all directions."
    },
    {
      "question": "Is there any truck in sight?",
      "answer": "Yes, there are trucks in the front and the front left."
    },
    {
      "question": "Is there any construction vehicle in sight?",
      "answer": "Yes, there is 1 construction vehicle in the front."
    },
    {
      "question": "Is there any traffic cone in sight?",
      "answer": "Yes, there are traffic cones in front right and back."
    },
    {
      "question": "Is there any rigid bus in sight?",
      "answer": "Yes, there is 1 rigid bus in the back."
    },
    {
      "question": "Is there any bicycle in sight?",
      "answer": "Yes, there is 1 bicycle in front."
    },
    {
      "question": "Is there any pushable or pullable object in sight?",
      "answer": "Yes, there is 1 pushable or pullable object in front."
    },
    {
      "question": "Are there any moving objects in front left of the car?",
      "answer": "Yes, there are moving objects in front left of the car."
    },
    {
      "question": "Are there any stationary objects in front left of the car?",
      "answer": "No, there are not any stationary objects in front left of the car."
    },
    {
      "question": "Are there any moving objects in front of the car?",
      "answer": "Yes, there are moving objects in front of the car."
    },
    {
      "question": "Are there any stationary objects in front of the car?",
      "answer": "Yes, there are stationary objects in front of the car."
    },
    {
      "question": "Are there any moving objects in front right of the car?",
      "answer": "Yes, there are moving objects in front right of the car."
    },
    {
      "question": "Are there any stationary objects in front right of the car?",
      "answer": "Yes, there are stationary objects in front right of the car."
    },
    {
      "question": "Are there any moving objects in back left of the car?",
      "answer": "Yes, there are moving objects in back left of the car."
    },
    {
      "question": "Are there any stationary objects in back left of the car?",
      "answer": "No, there are not any stationary objects in back left of the car."
    },
    {
      "question": "Are there any moving objects behind the car?",
      "answer": "Yes, there are moving objects behind the car."
    },
    {
      "question": "Are there any stationary objects behind the car?",
      "answer": "No, there are not any stationary objects behind the car."
    },
    {
      "question": "Are there any moving objects in back right of the car?",
      "answer": "Yes, there are moving objects in back right of the car."
    },
    {
      "question": "Are there any stationary objects in back right of the car?",
      "answer": "No, there are not any stationary objects in back right of the car."
    },
    {
      "question": "What is the closest object to the ego vehicle?",
      "answer": "The closest object to the ego vehicle is the traffic cone at the back, with a distance of 10.05 meters."
    },
    {
      "question": "What is the farthest object from the ego vehicle?",
      "answer": "The farthest object from the ego vehicle is the car at the front, at a distance of 81.44 meters."
    },
    {
      "question": "Are there any objects that could potentially block the path of the ego car?",
      "answer": "Yes, there are barriers in all directions that could potentially block the path of the ego car."
    },
    {
      "question": "Do any of the pedestrians pose a potential threat to the ego car?",
      "answer": "Yes, there are several pedestrians moving in various directions that could potentially intersect with the path of the ego car."
    },
    {
      "question": "Are there any large vehicles in close proximity to the ego car?",
      "answer": "Yes, there is a truck in front left at a distance of 17.05 meters and a rigid bus at the back at a distance of 53.27 meters."
    },
    {
      "question": "Are there objects rapidly approaching the ego vehicle?",
      "answer": "It is uncertain as it depends on their speed and direction, but there are several moving objects in all directions."
    },
    {
      "question": "Do any of the cars pose a potential threat to the ego car?",
      "answer": "Yes, there are several cars moving in different directions that could potentially intersect with the path of the ego car."
    },
    {
      "question": "Is the path in front of the ego car clear?",
      "answer": "No, the path in front of the ego car is not clear with various objects including pedestrians, cars, barriers, a truck, a construction vehicle and a pushable or pullable object."
    },
    {
      "question": "How many obstructions are in front of the car?",
      "answer": "There are 48 obstructions in front of the car."
    },
    {
      "question": "Do we have any obstructions on our left?",
      "answer": "Yes, we do have obstructions â€“ 1 adult pedestrian and 1 truck on front left and 2 adult pedestrians on back left."
    },
    {
      "question": "Do we have any obstructions on our right?",
      "answer": "Yes, we do have obstructions â€“ 8 adult pedestrians, 3 cars, 6 barriers and 1 traffic cone on front right and 4 adult pedestrians and 1 barrier on back right."
    },
    {
      "question": "Do we have any obstructions at our back?",
      "answer": "Yes, we do have obstructions â€“ 2 traffic cones, 1 car, 2 barriers, 4 adult pedestrians, and 1 rigid bus."
    }
  ]
}
```

:::

ã‚ãã¾ã§å®šæ€§çš„ãªè©•ä¾¡ã§ã¯ã‚ã‚Šã¾ã™ãŒã€ä¸€è¦‹ DriveLM ã¨ã»ã¼åŒç­‰ã§ã€å¤šæ§˜ãª QA ãŒç”Ÿæˆã§ãã¦ã„ã‚‹ã‚ˆã†ã«è¦‹å—ã‘ã‚‰ã‚Œã¾ã™.

ã—ã‹ã—ã€ã“ã® GPT-4 ã§ã®ç”Ÿæˆã«ã¯ã€ä¸Šã«ç¤ºã—ãŸ 1 ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ» 6 æ–¹å‘ç”»åƒã«å¯¾ã—ã¦ 50 å•ç¨‹åº¦ã® QA ã‚’ç”Ÿæˆã™ã‚‹ã®ã«ã‚‚**2 åˆ†åŠç¨‹åº¦**ã®å®Ÿè¡Œæ™‚é–“ãŒã‹ã‹ã‚Šã¾ã™.

nuScenes ã«ã¯ã€æ—¢ã« 30000 ä»¥ä¸Šã®ãƒ•ãƒ¬ãƒ¼ãƒ ãŒæ ¼ç´ã•ã‚Œã¦ã„ã¾ã™ã€‚å˜ç´”è¨ˆç®—ã§ã€30000 x 2.5(åˆ†) = 75000 åˆ† = **ç´„ 52 æ—¥**ã€‚ãƒãƒ«ãƒã‚¹ãƒ¬ãƒƒãƒ‰ã«ã‚ˆã‚‹é«˜é€ŸåŒ–ãŒã§ãã‚‹ã¨ã¯ã„ãˆã€OpenAI API ã«ã¯ä½¿ç”¨åˆ¶é™ãŒã‚ã‚‹ã“ã¨ã‚‚è€ƒæ…®ã™ã‚‹ã¨ã€ã“ã‚Œã¯ç¾å®Ÿçš„ãªã‚³ã‚¹ãƒˆã¨ã¯ã„ãˆã¾ã›ã‚“ã€‚

ãã®ãŸã‚ã€GPT-4 ã«ã‚ˆã‚‹å…¨ãƒ•ãƒ¬ãƒ¼ãƒ ã«å¯¾ã™ã‚‹ Question Answering ã®ç”Ÿæˆã¯è«¦ã‚ã€ç”Ÿæˆæ–¹æ³•ã‚’å†è€ƒã™ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚

ã“ã“ã§ã€GPT-4 ãŒç”Ÿæˆã—ãŸå…ˆã»ã©ã® QA ã‚„ DriveLM ã®ãƒ‡ãƒ¢ãƒ‡ãƒ¼ã‚¿ã«å«ã¾ã‚Œã¦ã„ãŸ QA ã‚’æ³¨æ„æ·±ãè¦³å¯Ÿã™ã‚‹ã¨ã€

```
Q. What objects are in front right of the ego car?
A. In front right of the ego car, there are 8 adult pedestrians, 3 cars, 6 barriers and 1 traffic cone.
```

ã®ã‚ˆã†ã« GPT ã‚’æ´»ç”¨ã›ãšã¨ã‚‚ã€ç‰¹ã«çŠ¶æ³æŠŠæ¡ã®ãŸã‚ã® QA ã§ã‚ã‚‹ Perception ã«é–¢ã—ã¦ã¯ã€**ãƒ«ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ãªãƒ­ã‚¸ãƒƒã‚¯ã§ BoundingBox ã®æƒ…å ±ã‚’å‡¦ç†ã™ã‚‹ã“ã¨ã§ã€ç”Ÿæˆã§ããã†ãª QA ã‚‚å¤šãå«ã¾ã‚Œã¦ã„ã‚‹**ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚

ãã“ã§ã€**Perception ã®ã‚ˆã†ãªã‚·ãƒ³ãƒ—ãƒ«ãª QA ã¯ãƒ«ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ãªãƒ­ã‚¸ãƒƒã‚¯ã§ç”Ÿæˆã—ã€Prediction ã‚„ Planning ã®ã‚ˆã†ã«æ€è€ƒã‚’å¿…è¦ã¨ã™ã‚‹ä¸€éƒ¨ QA ã®ã¿ã€GPT ã§ç”Ÿæˆã™ã‚‹**ã€ã¨ã„ã†æ–¹é‡ã«è»¢æ›ã‚’è¡Œã„ã€å®Ÿè¡Œæ™‚é–“ã®ç¯€ç´„ã‚’ç›®æŒ‡ã—ã¾ã—ãŸã€‚

# ãƒ«ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ + GPT3.5 ã«ã‚ˆã‚‹ Visual Question Answering ã®è‡ªå‹•ç”Ÿæˆ

## ãƒ«ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ã«ã‚ˆã‚‹ Perception ã®ç”Ÿæˆ

æ—¢ã«è¿°ã¹ãŸé€šã‚Šã€ç¾åœ¨ã®å‘¨å›²çŠ¶æ³ã‚’æŠŠæ¡ã™ã‚‹ãŸã‚ã«ç”¨ã„ã‚‰ã‚Œã‚‹ QA ã§ã‚ã‚‹ Perception ã«é–¢ã—ã¦ã¯ãƒ«ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ã®ãƒ­ã‚¸ãƒƒã‚¯ã‚’å®Ÿè£…ã—ã€QA ã‚’ç”Ÿæˆã—ã¾ã™ã€‚

ã¾ãšã€DriveLM ã‚„ GPT-4 ã§ç”Ÿæˆã—ãŸè³ªå•æ–‡ã‚’è¦³å¯Ÿã—ã€BoundingBox ã‚’ç”¨ã„ãŸãƒ«ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ã®ãƒ­ã‚¸ãƒƒã‚¯ã«ã‚ˆã‚Šç”Ÿæˆå¯èƒ½ãª Perception ã® QA ã‚’ä»¥ä¸‹ã® 5 ç¨®é¡ã«åˆ†é¡ã—ã¾ã—ãŸã€‚

- **Important Object Count and Direction**: ç‰¹å®šã®æ–¹å‘ã«å­˜åœ¨ã™ã‚‹é‡è¦ãªç‰©ä½“ã¨ãã®å€‹æ•°ã‚’èãè³ªå•
- **Object Presence Confirmation**: ç‰¹å®šæ–¹å‘ã«ã€ç‰¹å®šã®ç‰©ä½“ãŒå­˜åœ¨ã™ã‚‹ã‹ã©ã†ã‹ã‚’ç¢ºèªã™ã‚‹è³ªå•:
- **Object State Inquiry**: ç‰©ä½“ã®çŠ¶æ…‹(å‹•ã„ã¦ã„ã‚‹ã‹ã€ã„ãªã„ã‹)ã«é–¢ã™ã‚‹è³ªå•
- **Relative Distance to Vehicles**: å‘¨è¾ºç‰©ä½“ã¨è‡ªè»Šã¨ã®è·é›¢ã«é–¢ã™ã‚‹è³ªå•
- **Object Location Coordinates**: å‘¨è¾ºã®ç‰©ä½“ã®ä½ç½®åº§æ¨™æƒ…å ±ã«é–¢ã™ã‚‹è³ªå•

ä¸Šã® 5 åˆ†é¡ã®ãã‚Œãã‚Œã«å¯¾ã—ã¦,2 ~ 3 å€‹ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ç”¨æ„ã—ã€å„ 6 æ–¹å‘ç”»åƒã«å¯¾ã—ã€ç¶²ç¾…çš„ã« QA ã®ç”Ÿæˆã‚’è¡Œã„ã¾ã—ãŸã€‚

ä»¥ä¸‹ãŒç”Ÿæˆã—ãŸ QA ã®ä¸€éƒ¨ã§ã™ã€‚

```json
[
    {
        "sample_token": "e93e98b63d3b40209056d129dc53ceee",
        "question": "What is the important object in front left of the ego car?",
        "answer": "There are 3 trucks in front left of the ego car.",
        "question_type": "important_object_count_and_direction"
    },
    {
        "sample_token": "e93e98b63d3b40209056d129dc53ceee",
        "question": "How many important objects are there in front left of the ego car?",
        "answer": "In front left of the ego car, there are 3 trucks.",
        "question_type": "important_object_count_and_direction"
    },
    {
        "sample_token": "e93e98b63d3b40209056d129dc53ceee",
        "question": "Is the path in front left of the ego car clear?",
        "answer": "No, the path in front left of the ego car is not clear with various objects including trucks.",
        "question_type": "important_object_count_and_direction"
    },
    ...
```

34,149 æšã®ç”»åƒå…¨ã¦ã«å¯¾ã—ã¦ã€ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ»æ–¹å‘ãƒ»ç‰©ä½“å…¨ã¦ç¶²ç¾…çš„ã« QA ã®ç”Ÿæˆã‚’è¡Œã„ã€ä¸Šã®ã‚ˆã†ãª QA ã‚’**è¨ˆ 2,842,088 ä»¶(ç´„ 280 ä¸‡ä»¶)ç”Ÿæˆ**ã—ã¾ã—ãŸã€‚

## GPT3.5 ã«ã‚ˆã‚‹ Prediction & Planning ã®ç”Ÿæˆ

Prediction ã¨ Planning ã®ã‚ˆã†ã«æ€è€ƒã‚’å¿…è¦ã¨ã™ã‚‹ã‚ˆã†ãª QA ã«é–¢ã—ã¦ã¯ã€GPT ã‚’ç”¨ã„ã¦ç”Ÿæˆã‚’è¡Œã„ã¾ã—ãŸã€‚ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç­‰ã®è¨­å®šã«é–¢ã—ã¦ã¯ã€åŸºæœ¬çš„ã«ã¯ GPT-4 ã«ã‚ˆã‚‹ç”Ÿæˆã®ç« ã§ç´¹ä»‹ã—ãŸã®ã¨åŒã˜ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚

ä¸€éƒ¨ã€ç”Ÿæˆã•ã‚Œã‚‹ QA ã«ãƒ«ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ã§ç”Ÿæˆã—ãŸ Perception ã‚’å«ã‚ãšã€ Prediction ã¨ Planning ã®ã¿ã«é™å®šã™ã‚‹ã“ã¨ã‚’ç›®çš„ã¨ã—ã€ä»¥ä¸‹ã®æ–‡ç« ã‚’ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®`Overall Role`ã®ç« ã«è¿½è¨˜ã—ã¾ã—ãŸã€‚

```
- The pairs of "question" and "answer" you output can be categorized into two types: **Prediction** and **Planning**.
- Prediction is a pair of questions and answers asking about the future situation of significant objects around the ego-car. For example, you can mention pairs like question: "What is the future state of ego-vehicle?", answer: "The action is to maintain speed keep on go ahead, the reason is to keep a safe distance, high.".
- Planning is a pair of questions and answers that, based on the future situation of significant objects around the ego-car, formulates a reasonable plan and avoids dangerous actions. For example, you can mention pairs like question: "Based on the observation of back, what actions might the ego-vehicle take? What is the reason to take this action? What is the probability of taking this action?", answer: "The action is to go ahead, the reason is to keep a safe distance, high.".
```

ã¾ãŸã€Function Calling ã®ã‚¹ã‚­ãƒ¼ãƒã«ã€`question`ã¨`answer`ã«åŠ ãˆã€å‡ºåŠ›ã—ãŸ QA ãŒ`prediction`ã‹`planning`ã®ã©ã¡ã‚‰ãªã®ã‹ã€ã‚’ç¤ºã™`question_type`ã¨ã„ã†ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’è¿½åŠ ã—ã¾ã—ãŸ.

```json
    "properties": {
                ...
                "question_type": {
                    "type": "string",
                    "enum": ["prediction", "planning"],
                    "description": 'Question Type: "prediction" or "planning" ',
                }
            }
            ...
```

ä»¥ä¸Šã®è¨­å®šã‚’è¡Œã£ãŸä¸Šã§ GPT3.5 ã‚’ç”¨ã„ã¦ã€ç”Ÿæˆã—ãŸ QA ã®ä¸€éƒ¨ãŒä»¥ä¸‹ã«ãªã‚Šã¾ã™ã€‚

```json
[
  {
    "sample_token": "b94e98e801444b00ae1f120ab8f833e1",
    "question": "What possible dangers can arise from the surrounding situation?",
    "answer": "There are two cars in front of the ego car, one car and one bicycle behind the ego car. An adult pedestrian is also behind the ego car. These objects pose a potential risk of collision."
  },
  {
    "sample_token": "24959f3f5c6b4ce6a2ed1c54d7f5e3e7",
    "question": "Based on the observation of back right of the ego car, what actions might the ego-car take?",
    "answer": "The ego-car should maintain its current speed and keep a safe distance from the objects in the back right. The probability of taking this action is high."
  }
  ...
```

ä¸Šã®ã‚ˆã†ãªæ–¹æ³•ã§ QA ã®ãƒšã‚¢ã‚’åˆè¨ˆ **7,000** ä»¶ç”Ÿæˆã—ã¾ã—ãŸã€‚ä»Šå›ã¯ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ³ã®æœŸé–“çš„ãªéƒ½åˆã§ã€GPT-4 ã‚’ä½¿ã£ãŸå¤§é‡ã® Question-Answering ã®ç”ŸæˆãŒé–“ã«åˆã‚ãšã€Prediction and Planning ã®ç”Ÿæˆã«ã¯ GPT3.5 ã‚’ç”¨ã„ã¾ã—ãŸã€‚ã¾ãŸã€ç”Ÿæˆã—ãŸ QA ã®æ•°ã‚‚ Perception ã¨æ¯”è¼ƒã™ã‚‹ã¨éå¸¸ã«å°‘ãªã„ã§ã™ã€‚ã“ã®è¾ºã‚Šã¯ã€ä»Šå¾Œã®æ”¹å–„ã—ã¦ã„ããŸã„ã¨è€ƒãˆã¦ã„ã¾ã™ã€‚

# ã¾ã¨ã‚

ä»¥ä¸ŠãŒ 2 é€±é–“ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ³ã§å–ã‚Šçµ„ã‚“ã å†…å®¹ã®èª¬æ˜ã«ãªã‚Šã¾ã™ï¼

ä»Šå›ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ³ã§ã¯ã€**ç´„ 280 ä¸‡ä»¶ã® Question Answering ã‹ã‚‰ãªã‚‹ QA ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ AutoScenesQA ã®ä½œæˆã«å–ã‚Šçµ„ã¿ã¾ã—ãŸ**ã€‚AutoScenesQA ã¯å¤§éƒ¨åˆ†ã® Perception ã‚’ãƒ«ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ã®ãƒ­ã‚¸ãƒƒã‚¯ã§ç”Ÿæˆã—ã€Prediction & Planning ã‚’ GPT 3.5 ã§ç”Ÿæˆã—ã¾ã—ãŸã€‚

ä»Šå›ä½œæˆã—ãŸ AutoScenesQA ã§ã™ãŒã€2 é€±é–“ã¨ã„ã†æ™‚é–“çš„ãªåˆ¶ç´„ã®ä¸­ã§ä½œæˆã—ãŸã“ã¨ã‚‚ã‚ã£ã¦ã€ã¾ã ã¾ã æ”¹å–„ã®ä½™åœ°ãŒã‚ã‚Šã¾ã™ã€‚å…·ä½“çš„ã«ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªèª²é¡Œãƒ»æ”¹å–„ç‚¹ãŒæŒ™ã’ã‚‰ã‚Œã¾ã™ã€‚

- QA ã®å¤šæ§˜æ€§ãŒä½ã„(ç‰¹ã«ãƒ«ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ã§ä½œæˆã—ãŸ Perception)
- Prediction and Planning ã«ã¤ã„ã¦ã€GPT 3.5 ã«ã‚ˆã‚‹ç”Ÿæˆã§ã¯å¤šæ§˜æ€§ãŒä½ã„ãŸã‚ã€GPT 4 ã‚’åˆ©ç”¨ã—ãŸç”ŸæˆãŒå¿…è¦(å¤§é‡ç”Ÿæˆã—ã‚ˆã†ã¨ã—ãŸéš›ã« API åˆ¶é™ã®éƒ½åˆã§æ–­å¿µã›ã–ã‚‹ã‚’å¾—ãªã‹ã£ãŸ)
- ç¾çŠ¶ã€Bonding Box ã®æƒ…å ±ã—ã‹å…¥åŠ›ã§ãã¦ã„ãªã„ãŸã‚ã€ç”»åƒæƒ…å ±ã‚’ä½•ã‚‰ã‹ã®æ–¹æ³•ã§æŠ½å‡ºã—ã€ãã®æƒ…å ±ã‚’ãƒ™ãƒ¼ã‚¹ã¨ã—ãŸ QA ã‚‚è‡ªå‹•ç”Ÿæˆã—ãŸã„

ã“ã®è¾ºã‚Šã®æ”¹å–„ã«ã¤ã„ã¦ã¯ä»Šå¾Œã® Future Work ã¨ã—ã¦å–ã‚Šçµ„ã‚“ã§ã„ããŸã„ã§ã™ã€‚

ä»Šå›ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ³ã‚’é€šã—ã¦ã€è‡ªå‹•é‹è»¢ã® LLM å¿œç”¨ã«é–¢ã™ã‚‹ç›´è¿‘ã®ç ”ç©¶å‹•å‘ã‚’çŸ¥ã‚‹ã¨ã¨ã‚‚ã«ã€å®Ÿå¿œç”¨ã‚‚è¦‹æ®ãˆãŸå¤§è¦æ¨¡ãª QA ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®ä½œæˆã«ã‚‚å–ã‚Šçµ„ã‚€ã“ã¨ãŒã§ãã¾ã—ãŸã€‚å„ªç§€ãªã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒ»ãƒªã‚µãƒ¼ãƒãƒ£ãƒ¼ã®æ–¹ã€…ã¨æœ€æ–°ç ”ç©¶ã‚’ãƒ™ãƒ¼ã‚¹ã¨ã—ãŸè­°è«–ãŒã§ãã‚‹ã¨ã„ã†ã®ã¯ã€æœ¬å½“ã«æ¥½ã—ãã€ã¨ã¦ã‚‚æœ‰æ„ç¾©ãªæ™‚é–“ã§ã‚ã£ãŸã¨æ€ã„ã¾ã™ï¼Turing ã®æ–¹ã€…ã«ã€æ”¹ã‚ã¦å¾¡ç¤¼ç”³ã—ä¸Šã’ã¾ã™ã€‚

Turing ã§ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ³ã¯ã€å¼·ã„äººé”ã«å›²ã¾ã‚Œã¦ã€è‡ªå‹•é‹è»¢ã‚„ LLM ã¨ã„ã£ãŸãƒ†ãƒ¼ãƒã«é–¢ã—ãŸç ”ç©¶é–‹ç™ºãŒã—ã¦ã¿ãŸã„ï¼ã¨ã„ã†å­¦ç”Ÿã«ã¯æ˜¯éã¨ã‚‚ãŠå‹§ã‚ã—ãŸã„ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ³ã§ã™ã€‚(æˆæœãŒã„ã„æ„Ÿã˜ã§ã‚ã‚Œã°å›½éš›ä¼šè­°ã¸ã®æŠ•ç¨¿ã‚‚ã‚ã‚‹ã¨ã‹ã€‚)

Turing ã¯ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ³ã‚„æ–°å’ãƒ»ä¸­é€”ã®æ¡ç”¨ã‚’çµ¶è³›å‹Ÿé›†ä¸­ã§ã™ã€‚èˆˆå‘³ãŒã‚ã‚‹ã¨ã„ã†æ–¹ã¯ [Turing ã®å…¬å¼ã‚µã‚¤ãƒˆ](https://www.turing-motors.com/)ã‚„[æ¡ç”¨æƒ…å ±](https://www.turing-motors.com/jobs)ã‚’ã”è¦§ãã ã•ã„ã€‚ã‚«ã‚¸ãƒ¥ã‚¢ãƒ«ã«è©±ã‚’èã„ã¦ã¿ãŸã„ã¨ã„ã†æ–¹ã¯ã€ãƒªã‚µãƒ¼ãƒãƒãƒ¼ãƒ ã®[æ£šæ©‹ã•ã‚“](https://twitter.com/tanahhh)ã‚„[äº•ãƒä¸Š](https://twitter.com/inoichan)ã•ã‚“ã€AI ãƒ‡ã‚£ãƒ¬ã‚¯ã‚¿ãƒ¼ã®[å±±å£ã•ã‚“](https://twitter.com/ymg_aq)ã® Twitter DM ã«ãŠæ°—è»½ã«ã”é€£çµ¡ãã ã•ã„ã€‚
